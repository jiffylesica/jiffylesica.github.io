<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jiffy Lesica">

<title>Limitations of the Quantitative Approach to Bias and Fairness – My Awesome CSCI 0451 Blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-6de787833effe4777a6777a5e05fb578.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: white;
      }

      .quarto-title-block .quarto-title-banner {
        color: white;
background-image: url(../../img/landscape.png);
background-size: cover;
      }
</style>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">My Awesome CSCI 0451 Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Limitations of the Quantitative Approach to Bias and Fairness</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Jiffy Lesica </p>
            </div>
    </div>
      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>In his 2022 lecture, <em>The Limits of the Quantitative Approach to Discrimination</em>, Arvind Narayanan puts forth a provocative claim on the role of quantitative methods in the contemporary age: “currently quantitative methods are primarily used to justify the status quo. I would argue that they do more harm than good” (Narayanan 2022). However, such a claim can only be fully appreciated in the fuller context of his speech, including not only its evidence and subclaims, but also Narayanan’s own positionality. As Narayanan explains in his speech, the harmful effects of Quantitative Methods seen today are not due of any inherent flaw, but instead because we have misunderstood the role and value of numbers in a human society. As a quantitative scholar himself, Narayanan can provide a distinct level of specificity to this claim – of insider insight – which helps illuminate the tangible realities which beg us to take seriously that – as simple as it may sound – numbers actually can lie.</p>
<p>Narayanan highlights 7 key limitations of quantitative methods which he has observed in his time as a quantitative scientist: Choice of null hypothesis, Use of snapshot datasets, Use of data provided by company, Explaining away discrimination, Wrong locus of intervention, The objectivity illusion, and Performativity.</p>
<p>The <em>objectivity illusion</em> is the quantitative limitation which, in a way, is at the heart of all other limitations put forth in Narayanan’s essay. As such, it is at the heart of the logic which my essay puts forth. Acknowledging it necessarily brings about complications of snapshot data, explaining away discrimination, and even the performative policies which quantitative science has brought about. The objectivity illusion refers to the false belief that quantitative research is objective because numbers are objective. Quantitative research involves subjective decisions made by researchers at multiple steps throughout the process such as – as mentioned above – choice of dataset or data collection methods, how to frame research questions and findings, which variables to control and to test on, and what “counts” as statistical evidence of discrimination: “In a typical research paper I would say researchers make at least 10-20 subjective choices, each of which could substantially alter their conclusions” (Narayanan 2022). The objectivity illusion is also at the heart of the previously mentioned limitations of snapshot data sets. As D’ignazio and Klein explain, “data are not neutral or objective. They are products of unequal social relations, and this context is essential for conducting accurate, ethical analysis” (Data Feminism, Introduction). Contemporary theories in the humanities, while not directly engaging questions of the quantitative world, offer language which is helpful to clarify the objectivity illusion.</p>
<p>In his book <em>Crossing and Dwellings</em>, for example, Thomas Tweed draws from insights of his scholarship to encourage a dynamic and itinerant approach to religious theory. The reason I bring such a seemingly distant resource to this conversation is, well, because it may not be as distant as we think. In fact, the model of theory which Tweed puts forth is quite similar to the “adversarial collaboration” approach of interpreting data which Narayanan mentions as “admirable”, in that it “explicitly acknowledges that scientists have their biases, their pet theories, their favored and hoped for conclusions” which will ultimately bias – in conscious or unconscious ways – the methodological approach they bring to their research (Narayanan 2022). As Tweed writes, “it is precisely because we stand in a particular place that we are able to see, to know, to narrate” (Tweed 18). There is no independent access to the experiences or subjective states of another, only that which the scholar can ‘see’ – used by Tweed to represent the multi-sensory reception of the corporeal world before us (Tweed 17). And, it is from those sightings that a scholar is able to construct meaning using the “categories and criteria they inherit, revise, and create” (Tweed 18). In the quantitative world, such sightings are at particular risk of being incomplete not because it is inherently worse, but because it is just simply not possible yet – whether by nature or by the limitations of modern technology – to capture the depth and variety of human experience with numbers. It is in recognizing this reality that the first steps may be taken towards deconstructing the epistemic hierarchy which grips the quantitative world.</p>
<p>It is ultimately from the objectivity illusion that other limitations emerge. For example, take the <em>Choice of null hypothesis</em>. Quantitative communities have “settled on the absence of discrimination” as the default assumption. Choosing to see the world as impartial puts the burden of proof on those alleging discrimination, and naively pretends that quantitative scholars – or really that anyone – has the capacity to live in a world void of human subjectivity. Such a choice not only ignores, but may even perpetuate discrimination as it brushes aside the possibility of systemic discrimination – which manifests in implicit, everyday forms and compound over time – and holds us back from implementing the critical interventions which may help address discriminatory realities. To standardize the absence of discrimination holds a massive normative significance in that it encourages us to be blind to inequality unless it presents itself clearly and ‘objectively’, and even then, retain a level of skepticism towards it until it can be quantitatively confirmed. Narayanan’s observations about the choice and the null hypothesis point us to consider the principles upon which we build quantitative methods, and particularly how quantitative methods and researchers operate in relation to power. Quantitative scholars who follow the framework of Data Feminism, for example, would argue that such considerations should manifest in challenges to unequal power structures and working toward justice (Data Feminism, Introduction). However, even before such a principle can be acted on, scholars must first take seriously the existence of power structures, and the ways in which the data they evaluate grows within, exists in relation to, and is drawn from those contexts.</p>
<p>Furthermore, most datasets upon which quantitative methods are employed are collected from a “single system at a single point in time,” and it is even rarer for people to go out and collect new data. Such <em>snapshot datasets</em> are thus only frames in a much larger picture which inevitably involves systemic, social, and structural trends, “forcing the researcher to ignore people’s broader circumstances and the past discrimination they may have experienced” (Narayanan, 2022). If we assume that such data can provide sufficient view of discrimination, or a lack thereof, we are encouraged to believe discrimination happens in snapshots – in “discrete moments of time” and quantitatively observable ways – which is simply never how discrimination has operated. Other quantitative scholars affirm this limitation, such as D’ignazio and Klein who argue that “the process of converting life experience into data always necessarily entails a reduction of that experience” (Data Feminism, Introduction).</p>
<p>It is these misapprehensions which ultimately lead to Explaining away discrimination. In evaluating statistical disparities, quantitative researchers often diminish/set aside evidence of discrimination through their choice of analytical variables. Specifically, in trying to make their research logically/interpretatively sound, they control for variables that are tied to social constructs like race, subsequently excluding many of the proximal ways in which discrimination may actually operate. For example, Narayanan cites the 2004 study by Bertrand and Mullainathan which sent fake resumes to employers to test if an applicant’s race had an impact on the likelihood of them getting an interview. The way they implemented this was by creating pairs of resumes which were identical except for the applicant’s name, which would either be “White-sounding” (Emily, Greg, etc.) or “Black-sounding” (Lakisha, Jamal, etc.) (Narayanan 2022). While the study did find that “White names” were 50% more likely to receive a callback, it also limits our understanding of what data may signal someone’s social identity to their name: “Literally every other variable that might signal race or be correlated with race [other than one’s name] is held constant between the two conditions” (Narayanan 2022). Thus, while the study may have revealed discrimination in practice, it may have also “drastically underestimated” the degree of discrimination found in hiring practices (Narayanan 2022).</p>
<p>A 2016 paper by Mittelstadt et al.&nbsp;further highlights this limitation, asserting that “the outputs of algorithms also require interpretation.” As such, ‘objective’ correlations can come to reflect the interpreter’s “unconscious motivations, particular emotions, deliberate choices, socio-economic determinations, geographic or demographic influences” (Mittelstadt et al.&nbsp;2016). This point is reiterated in <em>Fairness and Machine Learning</em>, in which Barocas, Hardt, and Narayanan himself discuss the complexities which come with building fair machine learning models. If systematic discrimination persists in the world through subtle and systemic channels, it can’t be wholly identified in data that excludes those channels: “In real datasets, most attributes tend to be proxies for demographic variables,” meaning it is both irresponsible and dangerous to essentialize demographic identity to a single element, such as name signifying race (Fairness and Machine Learning 17).</p>
<p>However, while on one hand arguing about the present harms of quantitative methods, it would be insufficient to characterize Narayanan’s lecture as an exposé. He isn’t just saying what is wrong with this system, but rather presents a call to action and reformed thinking about the quantitative world. Eliminating quantitative methods from the conversation is neither desirable nor attainable, for the limitations which are found today are “not inherent to quantitative work” (Narayanan 2022). A better way of engaging with the quantitative world is possible, and steps made toward it can be seen today. On the surface, the proposition of taking seriously the subjectivity of human experience – of both the researcher and the researched – is not technically sophisticated enough. On the surface, the idea of developing research methods to measure and interpret systemic forms of discrimination – methods which “dig deeper” into the assumptions and politics which inevitably shape our engagement with the world (Narayanan 2022) – may not seem quantitatively plausible. However, it is only once we realize that the epistemic role of quantitative methods in a human world can never be absolute, because it is one of many ways of knowing the world, that we may begin to shift from predicting the world into fully reflecting on, understanding, and progressing from the form it inhabits right now.</p>
<p>The 2019 study conducted by Obermeyer et al., <em>Dissecting racial bias in an algorithm used to manage the health of populations</em>, provides a critical example of this digging deeper, and how quantitative methods can be employed to uncover and address systemic biases in algorithmic decision-making processes, specifically in healthcare risk prediction. In this research, the authors examined a commercially deployed prediction algorithm intended to identify patients who could benefit from extra medical support, known as “high-risk care management” programs (HRCMPs) (Obermeyer et al.&nbsp;2019). By exploring the data produced from one of these algorithms through quantitative methods, Obermeyer and colleagues revealed that the algorithm systematically underestimated the healthcare needs of Black patients. Specifically, they found that Black patients who had identical algorithmic risk scores - i.e.&nbsp;who were considered of equally high medical risk/eligible for HRCMP as their white counterparts - were considerably sicker on average. Specifically, they found that Black patients who were predicted as “very-high-risk” (at the point of being auto-identified from HRCMP enrollment) had 26% more chronic health conditions when compared to their White counterparts. After further searching, the authors identified that the algorithm predicts health care costs rather than illness, targeting patients with high costs are eligible for HRCMPs. However, in doing so the algorithm mistakenly equated lower healthcare expenditures by Black patients with lower healthcare needs, overlooking the structural inequalities that produce disparate costs across demographic groups.</p>
<p>While Black patients may spend less on healthcare than white patients, it is not because they are less sick. Instead, the authors identified that such a disparity arises from “unequal access to care” which has been driven by historical relationships – such as Black patients having reduced trust in the doctors – or socioeconomic barriers – such as access to transportation – which proximally impact the extent to which Black patients engage the health care system (Obermeyer et al.&nbsp;2019). If these patients are cared for less often, then they will ultimately spend less on health care, contributing to the predictive biases which the study identified.</p>
<p>This study provides an insightful application of the notion of calibration as detailed in <em>Fairness and Machine Learning</em>. Calibration, a quantitative fairness criterion, requires that risk scores accurately reflect outcomes equivalently across different demographic groups (Barocas et al.&nbsp;61-62). In the context of this study, a calibrated model ensures that, conditional on risk score, “predictions do not favor Whites or Blacks anywhere in the risk distribution” (Obermeyer et al.&nbsp;2019). Technically, the healthcare algorithm satisfied this calibration criterion when assigning risk scores based on healthcare expenditure. However, the study illuminated a crucial limitation: calibration alone does not account for systemic biases embedded within the outcomes themselves - in this case, healthcare costs rather than actual health condition or needs. While calibration seeks to produce proportional consistency, it can perpetuate deep-rooted inequities if the target outcome itself is unjustly biased. Relying on proxies like healthcare spending is problematic as it disproportionately reflects unequal access and historical discrimination rather than genuine patient health needs. In other words, even a technically fair model - one that accurately predicts on healthcare expenditures - can remain unjust if it systematically disadvantages groups facing structural inequality.</p>
<p>This study highlights the benefits of employing ‘epistemically humble’ (to stay in line with Narayanan’s language) quantitative methods in analyses of discrimination. The authors’ evaluation allows them to reveal how a seemingly neutral algorithm actually perpetuated discrimination. By quantifying the precise and various extents of disparity, the researchers make the reality of discrimination tangible, clear, and actionable. Subsequently, their analysis guides readers through possible interventions – such as reformulating the algorithm itself, or changing the data it is ultimately fed – that could substantially mitigate racial disparities, thus promoting equality. Therefore, Obermeyer et al’s study not only underscores the value of quantitative methods in exposing hidden biases, but also emphasizes the need to critically evaluate and choose fairness criteria that align with equity and justice.</p>
<p>Narayanan’s critique is not an outright dismissal of quantitative methods but rather a call to critically examine the assumptions and limitations that shape their applications. My analysis of Narayanan’s claim, contextualized through his concept of the <em>objectivity illusion</em>, has shown that the limitations he identifies are not inherent to quantitative methods, but arise from a failure to acknowledge the subjective decisions embedded in quantitative research processes. As this essay has argued, understanding that data is the product of contextually embedded relations and realities is key to dismantling the epistemic hierarchy that privileges quantitative approaches as neutral or objective.</p>
<p><span class="citation" data-cites="barocasFairnessMachineLearning2023">Barocas, Hardt, and Narayanan (<a href="#ref-barocasFairnessMachineLearning2023" role="doc-biblioref">2023</a>)</span> <span class="citation" data-cites="d2023data">D’ignazio and Klein (<a href="#ref-d2023data" role="doc-biblioref">2023</a>)</span> <span class="citation" data-cites="mittelstadt2016ethics">Mittelstadt et al. (<a href="#ref-mittelstadt2016ethics" role="doc-biblioref">2016</a>)</span> <span class="citation" data-cites="narayanan2022limits">Narayanan (<a href="#ref-narayanan2022limits" role="doc-biblioref">2022</a>)</span> <span class="citation" data-cites="Tweed+2008">Tweed (<a href="#ref-Tweed+2008" role="doc-biblioref">2008</a>)</span> <span class="citation" data-cites="obermeyer2019dissecting">Obermeyer et al. (<a href="#ref-obermeyer2019dissecting" role="doc-biblioref">2019</a>)</span></p>




<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-barocasFairnessMachineLearning2023" class="csl-entry" role="listitem">
Barocas, Solon, Moritz Hardt, and Arvind Narayanan. 2023. <em>Fairness and Machine Learning: Limitations and Opportunities</em>. <span>Cambridge, Massachusetts</span>: <span>The MIT Press</span>.
</div>
<div id="ref-d2023data" class="csl-entry" role="listitem">
D’ignazio, Catherine, and Lauren F Klein. 2023. <em>Data Feminism</em>. MIT press.
</div>
<div id="ref-mittelstadt2016ethics" class="csl-entry" role="listitem">
Mittelstadt, Brent Daniel, Patrick Allo, Mariarosaria Taddeo, Sandra Wachter, and Luciano Floridi. 2016. <span>“The Ethics of Algorithms: Mapping the Debate.”</span> <em>Big Data &amp; Society</em> 3 (2): 2053951716679679.
</div>
<div id="ref-narayanan2022limits" class="csl-entry" role="listitem">
Narayanan, Arvind. 2022. <span>“The Limits of the Quantitative Approach to Discrimination.”</span> Speech.
</div>
<div id="ref-obermeyer2019dissecting" class="csl-entry" role="listitem">
Obermeyer, Ziad, Brian Powers, Christine Vogeli, and Sendhil Mullainathan. 2019. <span>“Dissecting Racial Bias in an Algorithm Used to Manage the Health of Populations.”</span> <em>Science</em> 366 (6464): 447–53.
</div>
<div id="ref-Tweed+2008" class="csl-entry" role="listitem">
Tweed, Thomas A. 2008. <em>A Theory of Religion</em>. Cambridge, MA; London, England: Harvard University Press. <a href="https://doi.org/doi:10.4159/9780674044517">https://doi.org/doi:10.4159/9780674044517</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>